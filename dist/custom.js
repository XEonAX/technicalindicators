!function(e){"use strict";let t={};function r(e){let r=t["precision"];return r?parseFloat(e.toPrecision(r)):e}class s{}class i{constructor(e){this.format=e.format||r}static reverseInputs(e){e.reversedInput&&(e.values&&e.values.reverse(),e.open&&e.open.reverse(),e.high&&e.high.reverse(),e.low&&e.low.reverse(),e.close&&e.close.reverse(),e.volume&&e.volume.reverse(),e.timestamp&&e.timestamp.reverse())}getResult(){return this.result}}class n{constructor(e,t,r){this.next=r,r&&(r.prev=this),this.prev=t,t&&(t.next=this),this.data=e}}class l{constructor(){this._length=0}get head(){return this._head&&this._head.data}get tail(){return this._tail&&this._tail.data}get current(){return this._current&&this._current.data}get length(){return this._length}push(e){this._tail=new n(e,this._tail),0===this._length&&(this._head=this._tail,this._current=this._head,this._next=this._head),this._length++}pop(){var e=this._tail;if(0!==this._length)return this._length--,0===this._length?(this._head=this._tail=this._current=this._next=void 0,e.data):(this._tail=e.prev,this._tail.next=void 0,this._current===e&&(this._current=this._tail,this._next=void 0),e.data)}shift(){var e=this._head;if(0!==this._length)return this._length--,0===this._length?(this._head=this._tail=this._current=this._next=void 0,e.data):(this._head=this._head.next,this._current===e&&(this._current=this._head,this._next=this._current.next),e.data)}unshift(e){this._head=new n(e,void 0,this._head),0===this._length&&(this._tail=this._head,this._next=this._head),this._length++}unshiftCurrent(){var e=this._current;return e===this._head||this._length<2?e&&e.data:(e===this._tail?(this._tail=e.prev,this._tail.next=void 0,this._current=this._tail):(e.next.prev=e.prev,e.prev.next=e.next,this._current=e.prev),this._next=this._current.next,e.next=this._head,e.prev=void 0,this._head.prev=e,this._head=e,e.data)}removeCurrent(){var e=this._current;if(0!==this._length)return this._length--,0===this._length?(this._head=this._tail=this._current=this._next=void 0,e.data):(e===this._tail?(this._tail=e.prev,this._tail.next=void 0,this._current=this._tail):e===this._head?(this._head=e.next,this._head.prev=void 0,this._current=this._head):(e.next.prev=e.prev,e.prev.next=e.next,this._current=e.prev),this._next=this._current.next,e.data)}resetCursor(){return this._current=this._next=this._head,this}next(){var e=this._next;if(void 0!==e)return this._next=e.next,this._current=e,e.data}}class h extends i{constructor(e){super(e),this.period=e.period,this.price=e.values;this.generator=function*(e){var t,r=new l,s=0,i=1,n=yield;for(r.push(0);;)i<e?(i++,r.push(n),s+=n):(t=(s=s-r.shift()+n)/e,r.push(n)),n=yield t}(this.period),this.generator.next(),this.result=[],this.price.forEach((e=>{var t=this.generator.next(e);void 0!==t.value&&this.result.push(this.format(t.value))}))}nextValue(e){var t=this.generator.next(e).value;if(null!=t)return this.format(t)}}h.calculate=function(e){i.reverseInputs(e);var t=new h(e).result;e.reversedInput&&t.reverse();return i.reverseInputs(e),t};class o extends i{constructor(e){super(e);var t,r=e.period,s=e.values,i=2/(r+1);this.result=[],t=new h({period:r,values:[]});this.generator=function*(){for(var e,r=yield;;)void 0!==e&&void 0!==r?(e=(r-e)*i+e,r=yield e):(r=yield,(e=t.nextValue(r))&&(r=yield e))}(),this.generator.next(),this.generator.next(),s.forEach((e=>{var t=this.generator.next(e);null!=t.value&&this.result.push(this.format(t.value))}))}nextValue(e){var t=this.generator.next(e).value;if(null!=t)return this.format(t)}}o.calculate=function(e){i.reverseInputs(e);var t=new o(e).result;e.reversedInput&&t.reverse();return i.reverseInputs(e),t};class u extends i{constructor(e){super(e);var t=e.close,r=e.volume,s=e.period||1;if(r.length!==t.length)throw"Inputs(volume, close) not of equal size";let i=new o({values:[],period:s});this.result=[],this.generator=function*(){var e=yield,t=yield;let r;for(;;)r=(t.close-e.close)*t.volume,e=t,t=yield i.nextValue(r)}(),this.generator.next(),r.forEach(((e,s)=>{var i=this.generator.next({close:t[s],volume:r[s]});null!=i.value&&this.result.push(i.value)}))}nextValue(e){let t=this.generator.next(e).value;if(null!=t)return t}}function a(e){i.reverseInputs(e);var t=new u(e).result;return e.reversedInput&&t.reverse(),i.reverseInputs(e),t}u.calculate=a;class v extends i{constructor(e){super(e);var t=e.low,r=e.high,s=e.close,i=e.volume;this.format;if(t.length!==r.length||r.length!==s.length)throw"Inputs(low,high, close) not of equal size";this.result=[],this.generator=function*(){let e=yield,t=0,r=0;for(;;){let s=(e.high+e.low+e.close)/3;t+=e.volume*s,r+=e.volume,e=yield t/r}}(),this.generator.next(),t.forEach(((e,n)=>{let l=this.generator.next({high:r[n],low:t[n],close:s[n],volume:i[n]});null!=l.value&&this.result.push(l.value)}))}nextValue(e){let t=this.generator.next(e).value;if(null!=t)return t}}function c(e){i.reverseInputs(e);var t=new v(e).result;return e.reversedInput&&t.reverse(),i.reverseInputs(e),t}v.calculate=c;class p extends i{constructor(e){super(e);var t=e.high,r=e.low,s=e.close,i=e.open,n=e.volume,l=e.noOfBars;if(r.length!==t.length||t.length!==s.length||t.length!==n.length)throw"Inputs(low,high, close, volumes) not of equal size";this.result=[];var h,o,u,a,v=Math.max(...t,...r,...s,...i),c=Math.min(...t,...r,...s,...i),p=(v-c)/l,d=c;for(let e=0;e<l;e++){let e=d,l=e+p;d=l;let v=0,c=0,g=0;for(let p=0;p<t.length;p++){let d=r[p],m=t[p],x=i[p],f=s[p],w=n[p];o=l,a=m,((h=e)<=(u=d)&&o>=u||u<=h&&a>=h)&&(g+=w,x>f?c+=w:v+=w)}this.result.push({rangeStart:e,rangeEnd:l,bullishVolume:v,bearishVolume:c,totalVolume:g})}}nextValue(e){throw"Next value not supported for volume profile"}}function d(e){i.reverseInputs(e);var t=new p(e).result;return e.reversedInput&&t.reverse(),i.reverseInputs(e),t}p.calculate=d;class g extends i{constructor(e){super(e);let t=e.values,r=e.period,s=this.format;this.generator=function*(e){var t,r,i=yield,n=1,l=0,h=i;for(i=yield;;)(r=(r=i-h)>0?r:0)>0&&(l+=r),n<e?n++:t=void 0===t?l/e:(t*(e-1)+r)/e,h=i,t=void 0!==t?s(t):void 0,i=yield t}(r),this.generator.next(),this.result=[],t.forEach((e=>{var t=this.generator.next(e);void 0!==t.value&&this.result.push(t.value)}))}nextValue(e){return this.generator.next(e).value}}function m(e){i.reverseInputs(e);var t=new g(e).result;return e.reversedInput&&t.reverse(),i.reverseInputs(e),t}g.calculate=m;class x extends i{constructor(e){super(e);let t=e.values,r=e.period,s=this.format;this.generator=function*(e){var t,r,i=yield,n=1,l=0,h=i;for(i=yield;;)(r=(r=h-i)>0?r:0)>0&&(l+=r),n<e?n++:t=void 0===t?l/e:(t*(e-1)+r)/e,h=i,t=void 0!==t?s(t):void 0,i=yield t}(r),this.generator.next(),this.result=[],t.forEach((e=>{var t=this.generator.next(e);void 0!==t.value&&this.result.push(t.value)}))}nextValue(e){return this.generator.next(e).value}}function f(e){i.reverseInputs(e);var t=new x(e).result;return e.reversedInput&&t.reverse(),i.reverseInputs(e),t}x.calculate=f;class w{constructor(){this.open=[],this.high=[],this.low=[],this.close=[],this.volume=[],this.timestamp=[]}}class _ extends i{constructor(e){super(e);var t,r=e.period,s=e.values,i=1/r;this.result=[],t=new h({period:r,values:[]});this.generator=function*(){for(var e,r=yield;;)void 0!==e&&void 0!==r?(e=(r-e)*i+e,r=yield e):(r=yield,void 0!==(e=t.nextValue(r))&&(r=yield e))}(),this.generator.next(),this.generator.next(),s.forEach((e=>{var t=this.generator.next(e);null!=t.value&&this.result.push(this.format(t.value))}))}nextValue(e){var t=this.generator.next(e).value;if(null!=t)return this.format(t)}}_.calculate=function(e){i.reverseInputs(e);var t=new _(e).result;e.reversedInput&&t.reverse();return i.reverseInputs(e),t};class I extends i{constructor(e){super(e);var t=e.low,r=e.high,s=e.close,i=this.format;if(t.length!=r.length)throw"Inputs(low,high) not of equal size";this.result=[],this.generator=function*(){for(var e,t,r=yield;;)void 0===e&&(e=r.close,r=yield t),t=Math.max(r.high-r.low,isNaN(Math.abs(r.high-e))?0:Math.abs(r.high-e),isNaN(Math.abs(r.low-e))?0:Math.abs(r.low-e)),e=r.close,null!=t&&(t=i(t)),r=yield t}(),this.generator.next(),t.forEach(((e,i)=>{var n=this.generator.next({high:r[i],low:t[i],close:s[i]});null!=n.value&&this.result.push(n.value)}))}nextValue(e){return this.generator.next(e).value}}I.calculate=function(e){i.reverseInputs(e);var t=new I(e).result;e.reversedInput&&t.reverse();return i.reverseInputs(e),t};class y extends i{constructor(e){super(e);var t=e.low,r=e.high,s=e.close,i=e.period,n=this.format;if(t.length!==r.length||r.length!==s.length)throw"Inputs(low,high, close) not of equal size";var l=new I({low:[],high:[],close:[]}),h=new _({period:i,values:[],format:e=>e});this.result=[],this.generator=function*(){for(var e,t,r=yield;;)e=void 0===(t=l.nextValue({low:r.low,high:r.high,close:r.close}))?void 0:h.nextValue(t),r=yield e}(),this.generator.next(),t.forEach(((e,i)=>{var l=this.generator.next({high:r[i],low:t[i],close:s[i]});void 0!==l.value&&this.result.push(n(l.value))}))}nextValue(e){return this.generator.next(e).value}}function V(e){i.reverseInputs(e);var t=new y(e).result;return e.reversedInput&&t.reverse(),i.reverseInputs(e),t}y.calculate=V;class b extends i{constructor(e){super(e);this.format;let t=e.useATR,r=e.brickSize||0;if(t){let t=V(Object.assign({},e));r=t[t.length-1]}if(this.result=new w,0===r)return void console.error("Not enough data to calculate brickSize for renko when using ATR");let s=0,i=0,n=1/0,l=0,h=0,o=0;this.generator=function*(){let e=yield;for(;;){if(0===s){s=e.close,i=e.high,n=e.low,l=e.close,h=e.volume,o=e.timestamp,e=yield;continue}let t=Math.abs(e.close-l),u=Math.abs(e.close-s);if(t>=r&&u>=r){let o=t>u?s:l,a={open:o,high:i>e.high?i:e.high,low:n<e.low?n:e.low,close:o>e.close?o-r:o+r,volume:h+e.volume,timestamp:e.timestamp};s=a.open,i=a.close,n=a.close,l=a.close,h=0,e=yield a}else i=i>e.high?i:e.high,n=n<e.low?n:e.low,h+=e.volume,o=e.timestamp,e=yield}}(),this.generator.next(),e.low.forEach(((t,r)=>{var s=this.generator.next({open:e.open[r],high:e.high[r],low:e.low[r],close:e.close[r],volume:e.volume[r],timestamp:e.timestamp[r]});s.value&&(this.result.open.push(s.value.open),this.result.high.push(s.value.high),this.result.low.push(s.value.low),this.result.close.push(s.value.close),this.result.volume.push(s.value.volume),this.result.timestamp.push(s.value.timestamp))}))}nextValue(e){return console.error("Cannot calculate next value on Renko, Every value has to be recomputed for every change, use calcualte method"),null}}function P(e){i.reverseInputs(e);var t=new b(e).result;return e.reversedInput&&(t.open.reverse(),t.high.reverse(),t.low.reverse(),t.close.reverse(),t.volume.reverse(),t.timestamp.reverse()),i.reverseInputs(e),t}b.calculate=P;class E extends i{constructor(e){super(e);this.format;this.result=new w;let t=null,r=0,s=1/0,i=0,n=0,l=0;this.generator=function*(){let e=yield,h=null;for(;;){if(null===t)t=(e.close+e.open)/2,r=e.high,s=e.low,i=(e.close+e.open+e.high+e.low)/4,n=e.volume||0,l=e.timestamp||0,h={open:t,high:r,low:s,close:i,volume:e.volume||0,timestamp:e.timestamp||0};else{let n=(e.close+e.open+e.high+e.low)/4,l=(t+i)/2,o=Math.max(l,n,e.high),u=Math.min(e.low,l,n);h={close:n,open:l,high:o,low:u,volume:e.volume||0,timestamp:e.timestamp||0},i=n,t=l,r=o,s=u}e=yield h}}(),this.generator.next(),e.low.forEach(((t,r)=>{var s=this.generator.next({open:e.open[r],high:e.high[r],low:e.low[r],close:e.close[r],volume:e.volume?e.volume[r]:e.volume,timestamp:e.timestamp?e.timestamp[r]:e.timestamp});s.value&&(this.result.open.push(s.value.open),this.result.high.push(s.value.high),this.result.low.push(s.value.low),this.result.close.push(s.value.close),this.result.volume.push(s.value.volume),this.result.timestamp.push(s.value.timestamp))}))}nextValue(e){return this.generator.next(e).value}}function S(e){i.reverseInputs(e);var t=new E(e).result;return e.reversedInput&&(t.open.reverse(),t.high.reverse(),t.low.reverse(),t.close.reverse(),t.volume.reverse(),t.timestamp.reverse()),i.reverseInputs(e),t}E.calculate=S;class L extends l{constructor(e,t,r,s){if(super(),this.size=e,this.maintainHigh=t,this.maintainLow=r,this.maintainSum=s,this.totalPushed=0,this.periodHigh=0,this.periodLow=1/0,this.periodSum=0,!e||"number"!=typeof e)throw"Size required and should be a number.";this._push=this.push,this.push=function(e){this.add(e),this.totalPushed++}}add(e){this.length===this.size?(this.lastShift=this.shift(),this._push(e),this.maintainHigh&&this.lastShift==this.periodHigh&&this.calculatePeriodHigh(),this.maintainLow&&this.lastShift==this.periodLow&&this.calculatePeriodLow(),this.maintainSum&&(this.periodSum=this.periodSum-this.lastShift)):this._push(e),this.maintainHigh&&this.periodHigh<=e&&(this.periodHigh=e),this.maintainLow&&this.periodLow>=e&&(this.periodLow=e),this.maintainSum&&(this.periodSum=this.periodSum+e)}*iterator(){for(this.resetCursor();this.next();)yield this.current}calculatePeriodHigh(){for(this.resetCursor(),this.next()&&(this.periodHigh=this.current);this.next();)this.periodHigh<=this.current&&(this.periodHigh=this.current)}calculatePeriodLow(){for(this.resetCursor(),this.next()&&(this.periodLow=this.current);this.next();)this.periodLow>=this.current&&(this.periodLow=this.current)}}class H extends i{constructor(e){super(e),this.result=[];var t=Object.assign({},{conversionPeriod:9,basePeriod:26,spanPeriod:52,displacement:26},e),r=new L(2*t.conversionPeriod,!0,!0,!1),s=new L(2*t.basePeriod,!0,!0,!1),i=new L(2*t.spanPeriod,!0,!0,!1);this.generator=function*(){let e,n,l=Math.max(t.conversionPeriod,t.basePeriod,t.spanPeriod,t.displacement),h=1;for(n=yield;;){if(r.push(n.high),r.push(n.low),s.push(n.high),s.push(n.low),i.push(n.high),i.push(n.low),h<l)h++;else{let t=(r.periodHigh+r.periodLow)/2,n=(s.periodHigh+s.periodLow)/2;e={conversion:t,base:n,spanA:(t+n)/2,spanB:(i.periodHigh+i.periodLow)/2}}n=yield e}}(),this.generator.next(),e.low.forEach(((t,r)=>{var s=this.generator.next({high:e.high[r],low:e.low[r]});s.value&&this.result.push(s.value)}))}nextValue(e){return this.generator.next(e).value}}function M(e){i.reverseInputs(e);var t=new H(e).result;return e.reversedInput&&t.reverse(),i.reverseInputs(e),t}H.calculate=M;class C extends i{constructor(e){super(e);var t,r=new(e.useSMA?h:o)({period:e.maPeriod,values:[],format:e=>e}),s=new y({period:e.atrPeriod,high:[],low:[],close:[],format:e=>e});this.result=[],this.generator=function*(){var i;for(t=yield;;){var{close:n}=t,l=r.nextValue(n),h=s.nextValue(t);null!=l&&null!=h&&(i={middle:l,upper:l+e.multiplier*h,lower:l-e.multiplier*h}),t=yield i}}(),this.generator.next(),e.high.forEach(((t,r)=>{var s={high:t,low:e.low[r],close:e.close[r]},i=this.generator.next(s);null!=i.value&&this.result.push(i.value)}))}nextValue(e){var t=this.generator.next(e);if(null!=t.value)return t.value}}function z(e){i.reverseInputs(e);var t=new C(e).result;return e.reversedInput&&t.reverse(),i.reverseInputs(e),t}C.calculate=z;class k extends i{constructor(e){super(e);var t=e.high,r=e.low,s=e.close;this.result=[];var i=new y({period:e.period,high:[],low:[],close:[],format:e=>e}),n=new L(2*e.period,!0,!0,!1);this.generator=function*(){for(var t,r,s=yield{high:l,low:h};;){var{high:l,low:h}=s;n.push(l),n.push(h),r=i.nextValue(s),n.totalPushed>=2*e.period&&null!=r&&(t={exitLong:n.periodHigh-r*e.multiplier,exitShort:n.periodLow+r*e.multiplier}),s=yield t}}(),this.generator.next(),t.forEach(((e,t)=>{var i={high:e,low:r[t],close:s[t]},n=this.generator.next(i);null!=n.value&&this.result.push(n.value)}))}nextValue(e){var t=this.generator.next(e);if(null!=t.value)return t.value}}function q(e){i.reverseInputs(e);var t=new k(e).result;return e.reversedInput&&t.reverse(),i.reverseInputs(e),t}k.calculate=q,e.ChandelierExit=k,e.ChandelierExitInput=class extends s{constructor(){super(...arguments),this.period=22,this.multiplier=3}},e.ChandelierExitOutput=class extends s{},e.KeltnerChannels=C,e.KeltnerChannelsInput=class extends s{constructor(){super(...arguments),this.maPeriod=20,this.atrPeriod=10,this.useSMA=!1,this.multiplier=1}},e.KeltnerChannelsOutput=class extends s{},e.averagegain=m,e.averageloss=f,e.chandelierexit=q,e.fibonacciretracement=function(e,t){let r,s=[0,23.6,38.2,50,61.8,78.6,100,127.2,161.8,261.8,423.6];return r=e<t?s.map((function(r){let s=t-Math.abs(e-t)*r/100;return s>0?s:0})):s.map((function(r){let s=t+Math.abs(e-t)*r/100;return s>0?s:0})),r},e.forceindex=a,e.heikinashi=S,e.ichimokucloud=M,e.keltnerchannels=z,e.renko=P,e.volumeprofile=d,e.vwap=c}({});
